<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>小羅盤｜管理導航系統</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
body{background:#D8DCDD;font-family:sans-serif;}
.hard-shadow{box-shadow:4px 4px 0 #C8C0BE;border:2px solid #C8C0BE;}
.page{display:none;min-height:100vh;}
.page.active{display:block;}
.month-btn{padding:6px 12px;border:2px solid #C8C0BE;border-radius:10px;background:white;}
.month-btn.active{background:#F6D494;}
</style>
</head>

<body class="pb-24">

<nav id="top-nav" class="hidden sticky top-0 bg-white p-4 border-b">
<button onclick="goBack()" class="hard-shadow px-3 py-1 bg-white">←</button>
<span id="nav-title" class="ml-4 font-bold"></span>
</nav>

<!-- 首頁 -->
<div id="home" class="page active p-6">
<h1 class="text-3xl font-black mb-6">小羅盤</h1>

<div class="grid grid-cols-2 gap-4">

<div class="col-span-2 bg-[#F6D494] p-6 rounded-3xl hard-shadow cursor-pointer"
onclick="openPage('daily','現在行程')">
<h2 class="font-black">現在行程</h2>
<div id="live-task"></div>
</div>

<div class="bg-white p-5 rounded-3xl hard-shadow cursor-pointer"
onclick="openPage('yearly','年度行程')">年度行程</div>

<div class="bg-white p-5 rounded-3xl hard-shadow cursor-pointer"
onclick="openPage('crisis','危機處理')">危機處理</div>

</div>
</div>

<!-- 現在行程 -->
<div id="daily" class="page p-6">
<h2 class="text-2xl font-bold mb-4">現在該做什麼？</h2>
<div id="daily-content"></div>
</div>

<!-- 年度行程 -->
<div id="yearly" class="page p-6">
<h2 class="text-2xl font-bold mb-4">年度行程</h2>
<div id="month-tabs" class="flex flex-wrap gap-2 mb-4"></div>
<div id="month-content"></div>
</div>

<!-- 危機處理 -->
<div id="crisis" class="page p-6">
<h2 class="text-2xl font-bold mb-6">危機處理中心</h2>
<div class="space-y-4">

<div class="bg-white p-5 rounded-2xl hard-shadow cursor-pointer"
onclick="openPage('dinoCategory','恐龍闖關')">
恐龍家長情境練習
</div>

<div class="bg-white p-5 rounded-2xl hard-shadow cursor-pointer"
onclick="openPage('parentCategory','家長問題分類')">
查詢如何回覆家長問題
</div>

</div>
</div>

<!-- 恐龍分類 -->
<div id="dinoCategory" class="page p-6">
<h2 class="text-xl font-bold mb-4">選擇情境類別</h2>
<div id="category-list" class="space-y-3"></div>
<button onclick="viewHistory()" class="mt-4 text-blue-600 underline">
查看歷史紀錄
</button>
</div>

<!-- 遊戲區 -->
<div id="dinoGame" class="page p-6">
<h2 class="text-xl font-bold mb-4" id="game-title"></h2>
<div id="game-area"></div>
</div>

<script>

/* 現在行程邏輯 */

function getTodaySchedule() {
    const now = new Date();
    const hour = now.getHours();
    const minute = now.getMinutes();
    const totalMinutes = hour * 60 + minute;
    const day = now.getDay(); // 5=週五

    function between(sh, sm, eh, em){
        const start = sh*60+sm;
        const end = eh*60+em;
        return totalMinutes >= start && totalMinutes < end;
    }

    if (between(0,0,12,30)) return "休息時間";

    if (between(12,30,13,0)) {
        return `① 打掃騎樓<br>
        ② 確認孩子都有進班，若未通知未出現，記得訊息通知家長`;
    }

    if (between(13,0,13,30)) return "整理今日待辦事項";

    if (between(13,30,16,0)) {
        let text="行政工作";
        if(day===5) text+="<br>＋準備下週晚餐單";
        return text;
    }

    if (between(16,0,16,30)) {
        return `① 準備點心<br>
        ② 確認孩子都有進班，若未通知未出現，記得訊息通知家長<br>
        ③ 提醒老師傳當日晚餐單`;
    }

    if (hour===16 && minute>=30 && minute<40) return "訂晚餐";

    if (hour===16 && minute>=40 && minute<60) return "倒垃圾";

    if (between(17,0,20,0)) {
        return `① 叫學生回家<br>
        ② 行政工作<br>
        ③ 打掃`;
    }

    if (between(20,0,20,30)) {
        return `① 晚餐費用、零用金清點<br>
        ② 隔日待辦事項記錄`;
    }

    if (between(20,30,23,59)) return "休息時間";

    return "—";
}

function tick(){
const content=getTodaySchedule();
document.getElementById("live-task").innerHTML=content;
document.getElementById("daily-content").innerHTML=content;
}

tick();
setInterval(tick,60000);

/* ===== 年度行程（完整12月） ===== */

const annualSchedule = {
1:[
"確認總部活動",
"平日/週六考前加強",
"考前一週/考試當週：考卷90以上抽獎",
"期末考：95分以上3張/100分以上2張→兌換獎品",
"榜單印製",
"確認寒假英文/數學上課時間→寒假前兩週公告家長",
"確認下學期自修評量，聯繫書商",
"冬令營招生",
"冬令營名單確定",
"LINE調整為冬令營選單",
"寒假期間FB每天發文"
],
2:[
"確認總部活動",
"寒假期間FB每天發文",
"新學期安親課輔招生",
"確認下學期英文/數學上課時間→寒假最後一週公告家長",
"寒假最後一天設定預約訊息提醒開學",
"LINE調整為學期中選單",
"開學第一天下載安親檔案並通知老師",
"提醒長興/西勢國小學生交行事曆"
],
3:[
"確認總部活動",
"舉辦家長說明會→確認日期後FB宣傳",
"英文繪本班/小一正音班籌備開課",
"國小運動會進校園招生",
"馬不停蹄地招生"
],
4:[
"確認總部活動",
"英文繪本班/小一正音班開課",
"平日/週六考前加強",
"考前一週/考試當週：考卷90以上抽獎",
"期中考：95分以上3張/100分以上2張→兌換獎品",
"榜單印製",
"馬不停蹄地招生"
],
5:[
"確認總部活動",
"第一週：討論夏令營課表",
"第二週：確定夏令營課表",
"第三週：請總部設計宣傳單",
"第四週：夏令營宣傳（發文、貼通知單）"
],
6:[
"確認總部活動",
"平日/週六考前加強",
"考前一週/考試當週：考卷90以上抽獎",
"期末考：95分以上3張/100分以上2張→兌換獎品",
"榜單印製",
"確認暑假自修評量，聯繫書商",
"確認暑假英文/數學上課時間→暑假前兩週公告家長",
"夏令營招生",
"夏令營名單確定",
"LINE調整為夏令營選單"
],
7:[
"確認總部活動",
"暑假期間FB每天發文",
"提醒英文老師完成總部朗讀/演講活動"
],
8:[
"確認總部活動",
"確認下學期自修評量，聯繫書商",
"新學期安親課輔招生",
"確認下學期英文/數學上課時間→暑假最後一週公告家長",
"暑假最後一天提醒家長即將開學",
"LINE調整為學期中選單"
],
9:[
"確認總部活動",
"開學第一天下載安親檔案並通知老師",
"提醒長興/西勢/崑山國小學生交行事曆",
"開會討論萬聖節是否舉辦活動"
],
10:[
"確認總部活動",
"平日/週六考前加強",
"考前一週/考試當週：考卷90以上抽獎",
"期中考：95分以上3張/100分以上2張→兌換獎品",
"榜單印製",
"萬聖節活動"
],
11:[
"確認總部活動",
"第一週：討論冬令營課表/確認聖誕節活動",
"第二週：確定冬令營課表",
"第三週：請總部設計宣傳單",
"第四週：冬令營宣傳（發文、貼通知單）"
],
12:[
"確認總部活動",
"聖誕節活動宣傳",
"馬不停蹄地招生（冬令營）",
"聖誕節活動",
"元旦放假FB發文"
]
};

let currentMonth=new Date().getMonth()+1;

function renderMonths(){
let html="";
for(let i=1;i<=12;i++){
html+=`<button class="month-btn ${i===currentMonth?'active':''}"
onclick="selectMonth(${i})">${i}月</button>`;
}
document.getElementById("month-tabs").innerHTML=html;
renderMonth();
}
function selectMonth(m){currentMonth=m;renderMonths();}
function renderMonth(){
let html="";
annualSchedule[currentMonth].forEach(e=>{
html+=`<div class="bg-white p-3 mb-2 hard-shadow">${e}</div>`;
});
document.getElementById("month-content").innerHTML=html;
}
renderMonths();

/* ===== 恐龍題庫（5類共30題） ===== */
const questionBank={
"問班":[
{q:"數學一週幾天？費用？",o:["直接報價","先安排試聽","叫家長看公告"],c:1},
{q:"可以試聽嗎？",o:["要收費","免費安排","不能試聽"],c:1},
{q:"適合什麼班？",o:["隨便分","先測程度","看家長決定"],c:1},
{q:"有小班制嗎？",o:["沒有","依程度分班","不知道"],c:1},
{q:"可以旁聽嗎？",o:["不行","可預約參觀","隨便"],c:1},
{q:"教材是什麼？",o:["市售講義","依能力客製","不知道"],c:1}
],
"訊息":[
{q:"為何沒回訊息？",o:["很忙","說明處理時間","忽略"],c:1},
{q:"可以傳照片嗎？",o:["不行","整理後提供","看心情"],c:1},
{q:"成績如何？",o:["不清楚","提供分析","沒差"],c:1},
{q:"今天表現？",o:["還好","具體回饋","不知道"],c:1},
{q:"可以加LINE？",o:["不行","由官方窗口","隨便"],c:1},
{q:"有群組嗎？",o:["沒有","統一公告群組","自己問"],c:1}
],
"學費":[
{q:"隔壁便宜800",o:["那去那邊","說明價值差異","隨便"],c:1},
{q:"兄弟折扣？",o:["沒有","提供方案說明","不知道"],c:1},
{q:"可分期嗎？",o:["不行","協助規劃","隨便"],c:1},
{q:"只上英文可便宜？",o:["不能","說明成本結構","隨便"],c:1},
{q:"早鳥優惠？",o:["沒有","依活動說明","不知道"],c:1},
{q:"可退費嗎？",o:["不行","依規定說明","隨便"],c:1}
],
"上課時間":[
{q:"可改時段？",o:["不行","協助安排","不知道"],c:1},
{q:"臨時請假？",o:["扣堂","說明補課","隨便"],c:1},
{q:"課後班衝突？",o:["那沒辦法","另安排試聽","隨便"],c:1},
{q:"可以晚到？",o:["不行","提醒影響","隨便"],c:1},
{q:"可提前上？",o:["不能","評估安排","隨便"],c:1},
{q:"週末班？",o:["沒有","提供選項","不知道"],c:1}
],
"學生投訴":[
{q:"孩子被欺負",o:["不可能","立即了解","忽略"],c:1},
{q:"孩子不想來",o:["那別來","了解原因","隨便"],c:1},
{q:"老師兇他",o:["老師沒錯","調查回報","忽略"],c:1},
{q:"功課太多",o:["正常","調整建議","隨便"],c:1},
{q:"跟不上",o:["他太慢","安排輔導","隨便"],c:1},
{q:"考不好",o:["能力差","分析原因","隨便"],c:1}
]
};

let currentCategory="",qIndex=0,score=0,timer,timeLeft=10;

function renderCategories(){
let html="";
Object.keys(questionBank).forEach(cat=>{
html+=`<div class="bg-white p-4 hard-shadow cursor-pointer"
onclick="startGame('${cat}')">${cat}</div>`;
});
document.getElementById("category-list").innerHTML=html;
}
renderCategories();

function startGame(cat){
currentCategory=cat;qIndex=0;score=0;
openPage("dinoGame",cat+" 闖關");
nextQ();
}

function nextQ(){
let qs=questionBank[currentCategory];
if(qIndex>=qs.length){
saveHistory();
document.getElementById("game-area").innerHTML=
`完成！得分 ${score}/${qs.length}
<br><button onclick="openPage('dinoCategory','恐龍闖關')"
class="mt-3 bg-white p-2 hard-shadow">回分類</button>`;
return;
}
timeLeft=10;
let q=qs[qIndex];
let html=`剩餘時間：<span id="timer">${timeLeft}</span>秒
<div class="my-3 font-bold">${q.q}</div>`;
q.o.forEach((opt,i)=>{
html+=`<button onclick="checkA(${i})"
class="block w-full bg-white p-2 mb-2 hard-shadow">${opt}</button>`;
});
document.getElementById("game-area").innerHTML=html;

timer=setInterval(()=>{
timeLeft--;
document.getElementById("timer").innerText=timeLeft;
if(timeLeft<=0){clearInterval(timer);qIndex++;nextQ();}
},1000);
}

function checkA(i){
clearInterval(timer);
if(i===questionBank[currentCategory][qIndex].c)score++;
qIndex++;nextQ();
}

function saveHistory(){
let h=JSON.parse(localStorage.getItem("history")||"[]");
h.push({date:new Date().toLocaleString(),category:currentCategory,score:score});
localStorage.setItem("history",JSON.stringify(h));
}

function viewHistory(){
let h=JSON.parse(localStorage.getItem("history")||"[]");
let html="<h3 class='font-bold mb-2'>歷史紀錄</h3>";
h.forEach(r=>{
html+=`<div>${r.date}｜${r.category}｜${r.score}分</div>`;
});
document.getElementById("category-list").innerHTML=html;
}

/* 導航 */
let stack=["home"];
function openPage(id,title){
document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
document.getElementById(id).classList.add("active");
document.getElementById("top-nav").classList.remove("hidden");
document.getElementById("nav-title").innerText=title;
stack.push(id);
}
function goBack(){
stack.pop();
let prev=stack.pop()||"home";
document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
document.getElementById(prev).classList.add("active");
if(prev==="home")document.getElementById("top-nav").classList.add("hidden");
}

</script>
</body>
</html>
